# import boto3
# import pandas as pd

# def describeCR(client):
#     df = []
#     response = client.describe_capacity_reservations()
#     response = {'CapacityReservations': [{'CapacityReservationId': 'cr-00279d7d30ed91f09', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-00279d7d30ed91f09', 'AvailabilityZoneId': 'use1-az3', 'InstanceType': 'm4.4xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1e', 'Tenancy': 'default', 'TotalInstanceCount': 81, 'AvailableInstanceCount': 55, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-05-01T00:05:26.369000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-04-20T21:06:14+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '15'}]}, {'CapacityReservationId': 'cr-003bb897498fec235', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-003bb897498fec235', 'AvailabilityZoneId': 'use1-az3', 'InstanceType': 'c5.2xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1e', 'Tenancy': 'default', 'TotalInstanceCount': 92, 'AvailableInstanceCount': 46, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:00:46.196000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T16:59:52+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '92'}]}, {'CapacityReservationId': 'cr-004cb8aa496c2711f', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-004cb8aa496c2711f', 'AvailabilityZoneId': 'use1-az4', 'InstanceType': 'm4.10xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1d', 'Tenancy': 'default', 'TotalInstanceCount': 2, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-05-01T00:11:55.525000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-04-20T20:55:00+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '1'}]}, {'CapacityReservationId': 'cr-013c284214f1c5e26', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-013c284214f1c5e26', 'AvailabilityZoneId': 'use1-az5', 'InstanceType': 'c5.xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1f', 'Tenancy': 'default', 'TotalInstanceCount': 13, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:06:01.147000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T17:10:10+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '13'}]}, {'CapacityReservationId': 'cr-015aec16537392a0d', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-015aec16537392a0d', 'AvailabilityZoneId': 'use1-az4', 'InstanceType': 'm5.2xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1d', 'Tenancy': 'default', 'TotalInstanceCount': 1, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:13:13.568000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T17:00:53+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '2'}]}, {'CapacityReservationId': 'cr-02305faf7e4cb3ce7', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-02305faf7e4cb3ce7', 'AvailabilityZoneId': 'use1-az4', 'InstanceType': 't2.large', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1d', 'Tenancy': 'default', 'TotalInstanceCount': 37, 'AvailableInstanceCount': 3, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-05-01T00:05:23.052000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-04-20T21:06:59+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '52'}]}, {'CapacityReservationId': 'cr-0231124deb6306f9f', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-0231124deb6306f9f', 'AvailabilityZoneId': 'use1-az3', 'InstanceType': 'c5.12xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1e', 'Tenancy': 'default', 'TotalInstanceCount': 1, 'AvailableInstanceCount': 0, 'EbsOptimized': True, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-08-11T07:19:50+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-08-11T07:19:50+00:00', 'Tags': []}, {'CapacityReservationId': 'cr-02381f14268c719f2', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-02381f14268c719f2', 'AvailabilityZoneId': 'use1-az3', 'InstanceType': 'm5.large', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1e', 'Tenancy': 'default', 'TotalInstanceCount': 15, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:15:02.128000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T17:08:24+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '15'}]}, {'CapacityReservationId': 'cr-029b8bf9f06f6ea3f', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-029b8bf9f06f6ea3f', 'AvailabilityZoneId': 'use1-az4', 'InstanceType': 'c5.4xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1d', 'Tenancy': 'default', 'TotalInstanceCount': 12, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:00:50.032000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T16:59:57+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '12'}]}, {'CapacityReservationId': 'cr-02afb29fa0a81a5f9', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-02afb29fa0a81a5f9', 'AvailabilityZoneId': 'use1-az3', 'InstanceType': 't2.micro', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1e', 'Tenancy': 'default', 'TotalInstanceCount': 20, 'AvailableInstanceCount': 4, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-05-01T00:11:59.424000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-04-20T20:54:40+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '27'}]}, {'CapacityReservationId': 'cr-0307b9ff34e59865d', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-0307b9ff34e59865d', 'AvailabilityZoneId': 'use1-az5', 'InstanceType': 'c5.12xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1f', 'Tenancy': 'default', 'TotalInstanceCount': 1, 'AvailableInstanceCount': 0, 'EbsOptimized': True, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-08-11T07:28:21+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-08-11T07:28:21+00:00', 'Tags': []}, {'CapacityReservationId': 'cr-03df6ff6962964267', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-03df6ff6962964267', 'AvailabilityZoneId': 'use1-az4', 'InstanceType': 'm5.large', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1d', 'Tenancy': 'default', 'TotalInstanceCount': 34, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:13:14.765000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T17:00:56+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '36'}]}, {'CapacityReservationId': 'cr-03eaf46993f961874', 'OwnerId': '007313071900', 'CapacityReservationArn': 'arn:aws:ec2:us-east-1:007313071900:capacity-reservation/cr-03eaf46993f961874', 'AvailabilityZoneId': 'use1-az5', 'InstanceType': 'c5.2xlarge', 'InstancePlatform': 'Linux/UNIX', 'AvailabilityZone': 'us-east-1f', 'Tenancy': 'default', 'TotalInstanceCount': 5, 'AvailableInstanceCount': 0, 'EbsOptimized': False, 'EphemeralStorage': False, 'State': 'active', 'StartDate': '2021-11-17T17:05:59.833000+00:00', 'EndDateType': 'unlimited', 'InstanceMatchCriteria': 'open', 'CreateDate': '2021-10-28T17:10:08+00:00', 'Tags': [{'Key': 'aws:ec2capacityreservation:createdBy', 'Value': 'AWS Assisted'}, {'Key': 'aws:ec2capacityreservation:incrementalRequestedQuantity', 'Value': '5'}]}]}
#     response=response['CapacityReservations']
    
#     for i in response:
#         col1 = i['CapacityReservationId']
#         col2 = i['AvailabilityZone']
#         col3 = i['InstanceType']
#         col4 = i['TotalInstanceCount']
#         col5 = i['AvailableInstanceCount']
#         col6 = i['State']
#         col7 = i['StartDate']
#         col8 = i['EndDateType']
#         df.append([col1, col2, col3, col4, col5, col6, col7, col8])
#     df = pd.DataFrame(df)    
#     df.columns= ['CR_id', 'AZ', 'VM_Type', 'Total', 'Available', 'State', 'Start_date', 'End_date']
#     print(df) 



# def main():
#     AWS_SERVER_PUBLIC_KEY="AKIA47DRST6IQIFF6BI3"
#     AWS_SERVER_SECRET_KEY="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"
#     session = boto3.Session(
#         aws_access_key_id = AWS_SERVER_PUBLIC_KEY,
#         aws_secret_access_key = AWS_SERVER_SECRET_KEY,
#         region_name = "ap-south-1"
#     )
#     client = session.client('ec2')
#     describeCR(client)

# if __name__ == "__main__":
#     main()


